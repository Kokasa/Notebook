2025-01-04    17:32

status: #adult 
tags: [[Computer Science]], [[计算机指令]]


# 寻址方式

寻址指的就是 寻找操作数的地址 或者 下一条将要执行的指令地址

## 编址方式(Addressing)

编址 就是对计算机中各种存储设备的存储单元进行编号, 以便于cpu能准确找到他们, 编制的单位通常是字节(Byte), 也可能是字(word) 或者位(bit), 具体取决于计算机的体系结构

编址是寻址的基础, 只有有效地编址才能准确的寻址
### 常见编址方式

- 字节编址
	这是最常见的编址方式, 每个字节都有一个唯一的地址, 例如一个32位的计算机, 采用字节编址方式, 地址空间就有$2^{32}$字节
- 字编址
	每个字(每个字都由多个字节组成)都有一个唯一的地址, 例如一个32位计算机, 采用字编址, 每个字长4字节, 其地址空间就有$2^{32}\div4=2^{30}$个字
- 位编址
	很少见, 仅在某些特定的应用中可能会使用

### 什么是地址空间

地址空间指的是CPU可以访问的所有存储单元的集合, 地址空间的大小取决于cpu的地址总线宽度
例如一个32位地址总线的cpu, 地址空间为$2^{32}$字节

- 物理地址空间: 实际存在的物理内存的地址范围
- 逻辑地址空间: 程序使用的地址范围, 通过[[内存管理单元(Memory Management Unit, MMU)]]映射到物理地址空间

## 九种寻址方式(Addressing Modes)一览
cpu需要通过指令中给出的信息来找到所需的操作数或者指令的地址
不同的寻址方式有着不同的灵活性和效率

```
计算机中的指令一般都是提前设置好的, 数量有限且经过合理规划, 所以指令寻址方式比较简单, 顺序寻址和跳跃寻址就能满足基本所有要求, 但是对于操作数这种来源复杂的数据, 我们有大概九种左右的寻址方式:

- 立即寻址: 操作数就在指令中, 开箱即用

- 直接寻址: 给出地址, cpu去取

- 间接寻址: 给出内存单元地址, cpu去排查这个内存单元中的操作数

- 寄存器寻址: 给出寄存器单元编号中操作数位置, cpu去取

- 寄存器间接寻址: 给出寄存器单元编号, cpu排查出操作数

- 基址寻址: 对于连续的数据, 偏移量不变, 改变基址寄存器的数据来寻址

- 变址寻址: 对于连续的数据, 基址不变, 改变变址寄存器中的数据来控制偏移量

- 相对寻址: 以PC为基准, 设置偏移量来达到跳转语句的作用

- 堆栈寻址: 把操作数放在堆栈结构里, 压入弹出使用
```


1. 指令寻址: 寻找下一条指令的地址
	- 顺序寻址: 指令在内存中是顺序存储的, cpu按照这个顺序依次执行指令, [[程序计数器(Program Counter, PC)]]的值自动递增, 指向下一条指令的地址
	- 跳跃寻址: 通过转移指令(跳转, 分支等)来改变PC的值, 是程序跳转到指定的地址
2. 数据寻址
	- **立即寻址(Immediate Addressing)**: 操作数直接包含在指令之中, 这种方式, 寻址是最快的, 但是操作数大小受到指令字长的限制
	- **直接寻址(Direct Addressing)**: 指令中给出操作数的内存地址, cpu根据内存地址访问内存获取操作数
	- **间接寻址(Indirect Addressing)**: 
		- 指令中给出的地址是存放操作数的内存单元的地址
		- 这个内存单元中存放的不是数值, 而是一个地址, 访问现在这个间接的地址才能拿到操作数(可以多重间接存放), 过程较为繁琐
		- 但是得益于内存单元的大小, 可以存放更大的地址, 也就有更大的空间存放操作数
	- **寄存器寻址(Register Addressing)**: 操作数放在cpu寄存器中, 指令中给出的是寄存器的编号, 因为不需要访问内存, 所以也非常快
	- **寄存器间接寻址(Register Indirect Addressing)**: 和间接寻址类似, 只是这里给出的是寄存器的编号, cpu访问这个寄存器单元, 查出来操作数的地址, 然后访问地址得到操作数
	- **相对寻址(Relative Addressing)**: 操作数的地址是相对于PC的偏移量, 这种寻址常用语程序中的分支和循环
	- **基址寻址(Base Addressing)**: 操作数的地址是**基地址寄存器(不变)** 的内容加上指令给出的形式地址(作为偏移量), 常用于程序在内存中的重定位(系统内部)
	- **变址寻址(Indexed Addressing)**: 操作数的地址是**变址寄存器**的偏移量加上指令给出的形式地址(不变) 常用于数组和字符串的处理(面向用户)
	- **[[堆栈寻址(Stack Addressing)]]**: 操作数存放在堆栈中, 通过[[堆栈指针(Stack Pointer, SP)]]进行访问, 常用于函数调用和中断处理
	- 基址寻址, 变址寻址, 相对寻址, 这些寻址方式都属于[[三种偏移寻址方式]]


## 各种寻址方式的特点总结

| 寻址方式    | 操作数位置 | 地址计算方式        | 特点                 |
| ------- | ----- | ------------- | ------------------ |
| 立即寻址    | 指令中   | -             | 速度最快，但操作数范围有限      |
| 寄存器寻址   | 寄存器中  | -             | 速度很快               |
| 直接寻址    | 存储器中  | 直接给出地址        | 简单直接，但灵活性较差        |
| 间接寻址    | 存储器中  | 指令中给出地址的地址    | 扩大寻址范围，但速度较慢       |
| 寄存器间接寻址 | 存储器中  | 寄存器中存放地址      | 速度较快，扩大寻址范围        |
| 相对寻址    | 存储器中  | 当前指令地址 + 偏移量  | 用于程序跳转和循环          |
| 基址寻址    | 存储器中  | 基址寄存器内容 + 偏移量 | 访问数组和数据结构          |
| 变址寻址    | 存储器中  | 变址寄存器内容 + 偏移量 | 访问数组和数据结构，可动态改变偏移量 |
| 堆栈寻址    | 堆栈中   | 压栈和弹栈操作       | 用于函数调用和中断处理        |

![[九种寻址方式-1739930480289.png]]


# References

[[深度剖析计算机机器指令的组成]]

[[寻址和编址]]

[[间接寻址以及寄存器的作用]]
